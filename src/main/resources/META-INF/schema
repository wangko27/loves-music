DROP DATABASE IF EXISTS `mdee_loves_music`;

CREATE DATABASE `mdee_loves_music`;

-- Band --
DROP TABLE IF EXISTS `band`;

CREATE TABLE `band` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` VARCHAR(150) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Album --
DROP TABLE IF EXISTS `album`;

CREATE TABLE `album` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `title` VARCHAR(100) NOT NULL, `band_id` MEDIUMINT NOT NULL, `art_url` VARCHAR(1000) NOT NULL, FOREIGN KEY(band_id) REFERENCES band(id) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Song --
DROP TABLE IF EXISTS `song`;

CREATE TABLE `song` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `url` VARCHAR(1000) NOT NULL, `title` VARCHAR(200) NOT NULL, `album_id` MEDIUMINT NOT NULL, FOREIGN KEY(album_id) REFERENCES album(id) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Lyricist --
DROP TABLE IF EXISTS `lyricist`;

CREATE TABLE `lyricist` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` VARCHAR(100) NOT NULL, `pic_url` VARCHAR(1000)) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Lyric --
DROP TABLE IF EXISTS `lyric`;

CREATE TABLE `lyric` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `text` VARCHAR(5000) NOT NULL, `lyricist_id` MEDIUMINT NOT NULL, `song_id` MEDIUMINT NOT NULL, `date_added` DATE NOT NULL, `song_offset` SMALLINT NOT NULL, FOREIGN KEY(lyricist_id) REFERENCES lyricist(id) ON UPDATE CASCADE ON DELETE CASCADE, FOREIGN KEY(song_id) REFERENCES song(id) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Tag --
DROP TABLE IF EXISTS `tag`;

CREATE TABLE `tag` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` VARCHAR(100) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Lyricist Band Join Table --
DROP TABLE IF EXISTS `lyricist_band`;

CREATE TABLE `lyricist_band` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `lyricist_id` MEDIUMINT NOT NULL, `band_id` MEDIUMINT NOT NULL, FOREIGN KEY(lyricist_id) REFERENCES lyricist(id) ON UPDATE CASCADE ON DELETE CASCADE, FOREIGN KEY(band_id) REFERENCES band(id) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- Lyric Tag Join Table --
DROP TABLE IF EXISTS `lyric_tag`;

CREATE TABLE `lyric_tag` (`id` MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY, `lyric_id` MEDIUMINT NOT NULL, `tag_id` MEDIUMINT NOT NULL, FOREIGN KEY(lyric_id) REFERENCES lyric(id) ON UPDATE CASCADE ON DELETE CASCADE, FOREIGN KEY(tag_id) REFERENCES tag(id) ON UPDATE CASCADE ON DELETE CASCADE) ENGINE=InnoDB DEFAULT CHARSET=utf8;